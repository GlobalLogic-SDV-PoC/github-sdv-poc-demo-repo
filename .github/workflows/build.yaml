name: Build
on:
  workflow_call:

jobs:
  build:
    name: Build
    container: ubuntu:latest
    runs-on:
      - self-hosted
      - k8s-api
      - linux-arm64-s

    steps:
      - name: Checkout
        uses: actions/checkout@v3


      - name: Build and push
        uses: docker/build-push-action@v5
        with:
          context: .
          file: ./template.Dockerfile
          push: false
          tags: hitachiastemo-tools/tools:latest
          secrets: |
            AWS_ACCESS_KEY_ID=${{ secrets.AWS_ACCESS_KEY_ID }}
            AWS_SECRET_ACCESS_KEY=${{ secrets.AWS_SECRET_ACCESS_KEY }}
            PACKAGE_NAME=     "hitachiastemo-tools"
            VERSION=          "5.0.0"
            RELEASE_NUM=      "1"
            ARCH=             "all"
            DESCRIPTION=      "Customized LLVM"
            SRC_FOLDER=       "hitachiastemo-tools"
            DST_FOLDER=       "tools"
            HOMEPAGE=         "https://www.hitachiastemo.com"
            DEPS=             "libc6"
            MAINTAINER_NAME=  "hitachiastemo"
            MAINTAINER_EMAIL= "ha@dropmail.cc"
